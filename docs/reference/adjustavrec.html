<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>adjustavrec re-fits the AvRec saudatafile values in the MSE — adjustavrec • aMSE</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="adjustavrec re-fits the AvRec saudatafile values in the MSE — adjustavrec"><meta property="og:description" content="adjustavrec is used during the conditioning of the MSE to
    improve the fit to the time-series of CPUE by adjusting the SAU initial
    value for AvRec. Once the different SAU have been characterized and the
    data file values settled (even when sizemod has been used), when
    do_condition is run the fit of the predicted cpue and size-composition
    data can often be improved by re-fitting the AvRec constants in each SAU
    to adjust their values to better suit the population characteristics once
    random variation is added to each population's properties. adjustavrec
    does this automatically. Be wary of this function because it directly
    alters the values of AvRec inside the saudata.csv file. If the
    differences remain too great it may be necessary to adhust the recdevs
    as well (see optimizerecdevs)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aMSE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Comparing_Scenarios.html">Comparison of MSE Scenarios</a>
    </li>
    <li>
      <a href="../articles/model_documentation.html">Abalone MSE Model Documentation</a>
    </li>
    <li>
      <a href="../articles/the_data_files.html">Abalone MSE Data files</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/haddonm/aMSE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>adjustavrec re-fits the AvRec saudatafile values in the MSE</h1>
    <small class="dont-index">Source: <a href="https://github.com/haddonm/aMSE/blob/HEAD/R/docondition.R" class="external-link"><code>R/docondition.R</code></a></small>
    <div class="hidden name"><code>adjustavrec.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>adjustavrec is used during the conditioning of the MSE to
    improve the fit to the time-series of CPUE by adjusting the SAU initial
    value for AvRec. Once the different SAU have been characterized and the
    data file values settled (even when sizemod has been used), when
    do_condition is run the fit of the predicted cpue and size-composition
    data can often be improved by re-fitting the AvRec constants in each SAU
    to adjust their values to better suit the population characteristics once
    random variation is added to each population's properties. adjustavrec
    does this automatically. Be wary of this function because it directly
    alters the values of AvRec inside the saudata.csv file. If the
    differences remain too great it may be necessary to adhust the recdevs
    as well (see optimizerecdevs).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">adjustavrec</span><span class="op">(</span></span>
<span>  <span class="va">rundir</span>,</span>
<span>  <span class="va">glb</span>,</span>
<span>  <span class="va">ctrl</span>,</span>
<span>  <span class="va">calcpopC</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lowmult <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  highmult <span class="op">=</span> <span class="fl">1.4</span>,</span>
<span>  iterlim <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>rundir</dt>
<dd><p>the full path to the directory in which all files relating to a
particular run are to be held.</p></dd>


<dt>glb</dt>
<dd><p>the globals object</p></dd>


<dt>ctrl</dt>
<dd><p>the control object - contains datafile and controlfile names</p></dd>


<dt>calcpopC</dt>
<dd><p>a function that takes the output from hcrfun and generates
the actual catch per population expected in the current year.</p></dd>


<dt>verbose</dt>
<dd><p>Should progress comments be printed to console, default=TRUE</p></dd>


<dt>lowmult</dt>
<dd><p>multiplier to determine low range of search, default=0.6</p></dd>


<dt>highmult</dt>
<dd><p>multiplier to determine the high range of search, default=1.4</p></dd>


<dt>iterlim</dt>
<dd><p>the maximum number of iterations in the search for a solution,
default=30</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>nothing though it will write results to the console if verbose=TRUE</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="optimizerecdevs.html">optimizerecdevs</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># needs at least libraries, aMSE, hutils, makehtml, TasHS</span></span></span>
<span class="r-in"><span>  <span class="va">dropdir</span> <span class="op">&lt;-</span> <span class="fu">getDBdir</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">prefixdir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">dropdir</span>,<span class="st">"A_codeUse/aMSEUse/scenarios/"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">startime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">postfixdir</span> <span class="op">&lt;-</span> <span class="st">"S21"</span></span></span>
<span class="r-in"><span>  <span class="va">verbose</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="va">rundir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/makehtml/man/filenametopath.html" class="external-link">filenametopath</a></span><span class="op">(</span><span class="va">prefixdir</span>,<span class="va">postfixdir</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">controlfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"control"</span>,<span class="va">postfixdir</span>,<span class="st">".csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="confirmdir.html">confirmdir</a></span><span class="op">(</span><span class="va">rundir</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">zone1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">saudat</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="rewritecontrolfile.html">rewritecontrolfile</a></span><span class="op">(</span><span class="va">rundir</span>,<span class="va">zone1</span>,controlfile<span class="op">=</span><span class="va">controlfile</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="rewritedatafile.html">rewritedatafile</a></span><span class="op">(</span><span class="va">rundir</span>,<span class="va">zone1</span>,<span class="va">saudat</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="rewritecompdata.html">rewritecompdata</a></span><span class="op">(</span><span class="va">rundir</span>,<span class="va">zone1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">hsargs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mult<span class="op">=</span><span class="fl">0.1</span>,wid <span class="op">=</span> <span class="fl">4</span>,targqnt <span class="op">=</span> <span class="fl">0.55</span>,</span></span>
<span class="r-in"><span>                 maxtarg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">150</span>,<span class="fl">150</span>,<span class="fl">150</span>,<span class="fl">150</span>,<span class="fl">150</span>,<span class="fl">150</span>,<span class="fl">150</span>,<span class="fl">150</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 pmwts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.65</span>,<span class="fl">0.25</span>,<span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 hcr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.75</span>,<span class="fl">0.8</span>,<span class="fl">0.85</span>,<span class="fl">0.9</span>,<span class="fl">1</span>,<span class="fl">1.05</span>,<span class="fl">1.1</span>,<span class="fl">1.15</span>,<span class="fl">1.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 startCE <span class="op">=</span> <span class="fl">1992</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="do_condition.html">do_condition</a></span><span class="op">(</span><span class="va">rundir</span>,<span class="va">controlfile</span>,calcpopC<span class="op">=</span><span class="va">calcexpectpopC</span>,</span></span>
<span class="r-in"><span>                      verbose <span class="op">=</span> <span class="cn">TRUE</span>,doproduct <span class="op">=</span> <span class="cn">TRUE</span>,dohistoric<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                      mincount<span class="op">=</span><span class="fl">120</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="makeoutput.html">makeoutput</a></span><span class="op">(</span><span class="va">out</span>,<span class="va">rundir</span>,<span class="va">postfixdir</span>,<span class="va">controlfile</span>,hsfile<span class="op">=</span><span class="st">"TasHS Package"</span>,</span></span>
<span class="r-in"><span>             doproject<span class="op">=</span><span class="cn">FALSE</span>,openfile<span class="op">=</span><span class="cn">TRUE</span>,verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">adjustavrec</span><span class="op">(</span><span class="va">rundir</span>,<span class="va">out</span><span class="op">$</span><span class="va">glb</span>,<span class="va">out</span><span class="op">$</span><span class="va">ctrl</span>,calcpopC<span class="op">=</span><span class="va">calcexpectpopC</span>,verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># Now repeat the do_condition and makeoutput steps to see the final result</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Malcolm Haddon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

