<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>do_MSE an encapsulating function to hold the details of a single run — do_MSE • aMSE</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="do_MSE an encapsulating function to hold the details of a single run — do_MSE"><meta property="og:description" content="do_MSE is a form of meta-function that contains the code and
    function calls that constitute a single scenario run for aMSE. This is
    the reason the argument list is as long as it is. The code has been
    encapsulated like this to simplify development, maintenance, and
    distribution. Already with the number of variant conditioning examples
    produced as tests of the code-base, errors have arisen through a failure
    to propagate all changes to the code now in this function to all the
    separate MSE run files used to manage each scenario. A potential flaw
    lies with the need to apply the jurisdictionHS functions to any
    historical fishery data used to condition the operating model, ready for
    the first year of the projections. Currently, the code used is unique to
    the Tasmanian case and this obviously still requires generalization.
    This may require a new function to be produced in each jurisdictionHS.R
    file, but that is still under consideration. Part of the development of
    this meta-function will be to further articulate the generation of
    results, and the inclusion of error traps on the argument list entries.
    To aid in the conditioning the option of not calculating the productivity
    has been added. By default it will occur and when projecting it will also
    always occur. HSstats is a list that is always saved and contains
    performance statistics for the HS used (currently contains sum5 and sum10
    the cumulative catches to 5 and 10 years into the projections)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aMSE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Comparing_Scenarios.html">Comparison of MSE Scenarios</a>
    </li>
    <li>
      <a href="../articles/model_documentation.html">Abalone MSE Model Documentation</a>
    </li>
    <li>
      <a href="../articles/the_data_files.html">Abalone MSE Data files</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/haddonm/aMSE/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>do_MSE an encapsulating function to hold the details of a single run</h1>
    <small class="dont-index">Source: <a href="https://github.com/haddonm/aMSE/blob/HEAD/R/domse.R" class="external-link"><code>R/domse.R</code></a></small>
    <div class="hidden name"><code>do_MSE.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>do_MSE is a form of meta-function that contains the code and
    function calls that constitute a single scenario run for aMSE. This is
    the reason the argument list is as long as it is. The code has been
    encapsulated like this to simplify development, maintenance, and
    distribution. Already with the number of variant conditioning examples
    produced as tests of the code-base, errors have arisen through a failure
    to propagate all changes to the code now in this function to all the
    separate MSE run files used to manage each scenario. A potential flaw
    lies with the need to apply the jurisdictionHS functions to any
    historical fishery data used to condition the operating model, ready for
    the first year of the projections. Currently, the code used is unique to
    the Tasmanian case and this obviously still requires generalization.
    This may require a new function to be produced in each jurisdictionHS.R
    file, but that is still under consideration. Part of the development of
    this meta-function will be to further articulate the generation of
    results, and the inclusion of error traps on the argument list entries.
    To aid in the conditioning the option of not calculating the productivity
    has been added. By default it will occur and when projecting it will also
    always occur. HSstats is a list that is always saved and contains
    performance statistics for the HS used (currently contains sum5 and sum10
    the cumulative catches to 5 and 10 years into the projections).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">do_MSE</span><span class="op">(</span></span>
<span>  <span class="va">rundir</span>,</span>
<span>  <span class="va">controlfile</span>,</span>
<span>  <span class="va">hsargs</span>,</span>
<span>  <span class="va">hcrfun</span>,</span>
<span>  <span class="va">sampleCE</span>,</span>
<span>  <span class="va">sampleFIS</span>,</span>
<span>  <span class="va">sampleNaS</span>,</span>
<span>  <span class="va">getdata</span>,</span>
<span>  <span class="va">calcpopC</span>,</span>
<span>  <span class="va">makeouthcr</span>,</span>
<span>  <span class="va">hcrscoreoutputs</span>,</span>
<span>  <span class="va">HSPMs</span>,</span>
<span>  fleetdyn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  interimout <span class="op">=</span> <span class="st">""</span>,</span>
<span>  varyrs <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  startyr <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ndiagprojs <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cutcatchN <span class="op">=</span> <span class="fl">56</span>,</span>
<span>  matureL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span>  wtatL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">200</span><span class="op">)</span>,</span>
<span>  mincount <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  includeNAS <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  depensate <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  kobeRP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>rundir</dt>
<dd><p>the full path to the directory in which all files relating to a
particular run are to be held.</p></dd>


<dt>controlfile</dt>
<dd><p>the filename of the control file present in rundir
containing information regarding the particular run.</p></dd>


<dt>hsargs</dt>
<dd><p>the constants used to define the workings of the hcr</p></dd>


<dt>hcrfun</dt>
<dd><p>the name of the harvest control rule that is used to
calculate the aspirational catches by SAU or TAC by zone for the
following year</p></dd>


<dt>sampleCE</dt>
<dd><p>a function from jurisdictionHS.R that generates the CPUE
statistics from the projected data</p></dd>


<dt>sampleFIS</dt>
<dd><p>a function from jurisdictionHS.R that generates the FIS
statistics</p></dd>


<dt>sampleNaS</dt>
<dd><p>a function from jurisdictionHS.R that generates the
Numbers-at-size samples</p></dd>


<dt>getdata</dt>
<dd><p>a function that gathers all the data required by the hcrfun
and combines it into an hcrdata object ready for the hcrfun</p></dd>


<dt>calcpopC</dt>
<dd><p>a function that takes the output from hcrfun (either the
aspirational catch x SAU or TAC x zone) and generates the actual catch
per population in each SAU expected in the current year.</p></dd>


<dt>makeouthcr</dt>
<dd><p>Another JurisdictionHS.R function that generates (or not)
an object that is continually updated by the hcrfun. To avoid very
inefficient code this object (at least for Tasmania) is cycled through
the iterations.</p></dd>


<dt>hcrscoreoutputs</dt>
<dd><p>A function defined in an extra aMSE package or
source file, that defines how the hcr scores should be dealt with. In
Tasmania they recreated from the projections, plotted and their values
snet out into the scores object.</p></dd>


<dt>HSPMs</dt>
<dd><p>Another function defined in the HS package that reconstructs
the cpue HSPM scores, and other measures ready for plotting</p></dd>


<dt>fleetdyn</dt>
<dd><p>a function that calculates the distribution of catch across
the sau and populations. Currently not needed by Tas but needed by SA</p></dd>


<dt>interimout</dt>
<dd><p>should results be saved after projections have finished?
the default="", which means nothing is saved if no risk of crashing in
subsequent analyses. But if trying new stuff which may waste lots of time
if the projections need to be repeated, the set interimout = c(outdir,
postfixdir), which should be defined in the run_aMSE you are using,
and that will save the main objects needed for later analysis in the
directory used to save final results. The ordering of</p></dd>


<dt>varyrs</dt>
<dd><p>how many years at the end of the conditioning on the fishery,
data into zoneDD, to which to add recruitment variation, default = 7,
which suits the Tasmanian west coast. Used in prepareprojection</p></dd>


<dt>startyr</dt>
<dd><p>the index for the first year of the conditioning dynamics to
include in the plotted cpue trajectories, to give startyr:indexoflastyear.
used in sauplots.</p></dd>


<dt>verbose</dt>
<dd><p>Should progress comments be printed to console, default=FALSE</p></dd>


<dt>ndiagprojs</dt>
<dd><p>the number of replicate trajectories to plot in the
diagnostics tab to illustrate ndiagprojs trajectories to ensure that
such projections appear realistic; default=3</p></dd>


<dt>cutcatchN</dt>
<dd><p>to reduce the size of the final array of numbers-at-size
in the catch one can remove all the empty cells below a given size
class. In the default there are 105 2mm size classes and setting
cutcatchN = 56 removes size classes 1:55 2 - 110 mm; only from catchN</p></dd>


<dt>matureL</dt>
<dd><p>is a vector of 2, default = c(70,200), that define the x-axis
bounds on the biology maturity-at-Length plots</p></dd>


<dt>wtatL</dt>
<dd><p>is a vector of 2, default = c(80,200), that define the x-axis
bounds on the biology weight-at-Length plots</p></dd>


<dt>mincount</dt>
<dd><p>given size-composition data what minimum sample size will
be deemed acceptable for inclusion in the plots and conditioning.
default=100.</p></dd>


<dt>includeNAS</dt>
<dd><p>should the NAS projections be included in the output. If
they are then the final output size is greatly increased. default=FALSE</p></dd>


<dt>depensate</dt>
<dd><p>should depensation occur. If &gt; 0, eg depensate=0.2, then
depensation will occur when depletion is &lt; whatever value one puts in for
depensate. Implemented inside the function 'oneyearrec'</p></dd>


<dt>kobeRP</dt>
<dd><p>reference points for the eHS pseudo kobe plot. A vector of the
targdepl, default=0.4, limdepl, default=0.2, and the limH, default=0.15</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a large list containing tottime, projtime, starttime, glb, ctrl,
    zoneDD, zoneDP, projC, condC, sauout, and outzone</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="makeequilzone.html">makeequilzone</a>, <a href="dohistoricC.html">dohistoricC</a>, <a href="prepareprojection.html">prepareprojection</a>,
 <a href="doprojections.html">doprojections</a>, <a href="getprojyrC.html">getprojyrC</a>, <a href="oneyearrec.html">oneyearrec</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"wait on suitable data sets in data"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "wait on suitable data sets in data"</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Malcolm Haddon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

