---
title: "Abalone MSE Data files"
author: "Malcolm Haddon, ..."
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Abalone MSE Data files}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo = TRUE,
  message = FALSE,
  warning = FALSE
)

options(knitr.kable.NA = "",
        knitr.table.format = "pandoc")

options("show.signif.stars"=FALSE,
        "stringsAsFactors"=FALSE,
        "max.print"=50000,
        "width"=240)

library(aMSE)
library(codeutils)
library(hplot)
library(knitr)
library(captioner)

tab_nums <- captioner(prefix = "Table")
fig_nums <- captioner(prefix = "Figure")

if (dir.exists("C:/Users/Malcolm/Dropbox")) {
  ddir <- "C:/Users/Malcolm/Dropbox/A_CodeUse/aMSEUse/"
} else {
  ddir <- "C:/Users/User/Dropbox/A_CodeUse/aMSEUse/"
}

```

<style type="text/css">
  body, td {
     font-size: 18px;
     font-family: "Times New Roman", Times, serif;
  }
  code.r{
    font-size: 12px;
  }
  pre {
    font-size: 8px
  }
  h1 {
    font-size: 32px
  }
  .inline{
     font-size: 15px;
  }
  .display{
     font-size: 18px;
  }
</style>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { 
      equationNumbers: { 
            autoNumber: "all",
            formatNumber: function (n) {return '3.'+n}
      } 
  }
});
</script>



# Introduction

This document is part of the more formal documentation for the R package __aMSE__, which aims to provide a common modelling framework to test abalone harvest strategies. Being one of the vignettes included in the package it should be regarded as a living, adaptable document that will be modified as experience increases around different jurisdictions, and the authorship should be expected to alter accordingly as different people contribute.

## Stages of an MSE Run

There are a number of requirements when conducting an Management Strategy Evaluation of alternative harvest strategies on an abalone fishery. It is currently best to use the _RStudio_ integrated development environment, as this facilitates the installation of different R packages, and the editing and running of the R files used to conduct the actual scenario runs. 

The R packages required to run a scenario include at least:

* __aMSE__ the main R package containing the operating model and auxillary functions used.
* __hutils__ an R package containing numerous utility functions that are common to many simulation tasks.
* __hplot__ am R pacakge containing functions to facilitate plotting in base R.
* __knitr__ an R package used in vignette preparation and the production of formal tables
* _jurisdictionHS.R_ a source R file containing functions unique to a particular juridiction's harvest strategy.
* other packages may be required depending upon what packages are called within _jurisdictionHS.R_.

Most importantly for this document there are also a number of other data files required for a scenario run and these are all _.csv_ files. In the sections below we will go through their structure and contents in detail to act as a guide to their format and functioning:

* a _control.csv_ file (whose name can be anything the user wishes), that holds control options and many other constants.
* a _saubiology.csv_ file, that holds parameterizations of the biological properties of the _SAU_ and _populations_ that make up the operating model.

There may also be other data files if such data are available, these include:

* a size-composition of commercial catch data file
* a size-composition of fishery-independent survey file



When using the R package __aMSE__ a typical scenario run would entail a number of fundamental steps:

* Initiate each _population_ within each _SAU_ in the operating model with its biological properties.
* Generate the equilibrium unfished zone across all populations and estimate the productivity of each _population_ (and hence each _SAU_ and the total _zone_).
* Condition the operating model using either a hypothetical depletion or apply historical fishery data until the simulated _zone_ is ready to be projected under control of the particular harvest strategy being considered (__`r fig_nums("f1",display="cite")`__).
* Conduct the projections and summarize the results.

<br>


```{r FIG1, echo=FALSE, out.width = '65%', fig.align='center'}

knitr::include_graphics(paste0(ddir,"figures/AlternativeMSE.png"))
```

`r fig_nums("f1", caption=" A spectrum of alternative approaches for initiating and using the MSE framework.")`

<br>

## File Locations for a Scenario Run

Within __aMSE__, it is expected that all data files and all result files will be contained in the same directory. Within the __aMSE__ code, this directory is referred to as the _rundir_ (as in run-directory). It is suggested that each scenario run be given a unique name that is then used as the _rundir_ name. For example, if examining the influence of the legal minimum length (LML) on the outcome of using a particular harvest strategy (perhaps the TasmanianHS) one might have the following scenarios: lml140, lml145, lml150, and so on, all contained in a sub-directory named 'scenarios'. This would make future comparisons simpler to select. But of course, a user may name their _rundir_ whatever they wish.

The intent is that the _control.csv_ and _saubiology.csv_ files (and the _jurisdictionHS.R_ file) be stored in the _rundir_. If this means that the _saubiology.csv_ file would be replicated identically in each scenario sub-directory, then, instead, that file can be stored in a separate _datadir_ as an option. Here we will focus solely on the data files. There are (or will be) functions to generate data file templates for each of the data-file types. These can be run and the resulting templates edited to form the required files. Alternatively, the example data-files, made available with the __aMSE__ package, can be copied and edited appropriately as an alternative option.

Similarly, within __aMSE__, there are functions to read in each type of data-file. If there is a formatting error within the data-file it should throw an error which identifies where it has gone wrong. Further development will be applied to these error checks.


The input data-files all, currently, are required to be _.csv_ files where components with multiple values use a comma as a separator. This makes their preparation using software such as _Microsoft Excel_ relatively simple. 

The first of the two files is the _control.csv_, which contains a wide range of settings concerning the structure of the Operating Model as well as any historical conditioning data from a given fishery, if such conditioning is required. The second file is the _saubiology.csv_ file that contains the data that is used to define the biological properties of the _populations_ that are contained in the _SAU_ that make up the simulated _zone_. The rest of this document provides a detailed description of the contents and format of these files. 

## The Conditioning Requirements

There is a spectrum to the degree to which the operating model is conditioned on a real fishery. At the least specific one still has to include a spatial structure that reflects a typical abalone stock (in __aMSE__ the top level is the _zone_, which contains one or more _SAU_, which each contain one or more _populations_). This can be customized to suit a particular species, and one could include what might be deemed typical characteristics of growth, maturity, emergence and other details, including variation among the different populations found within each SAU. Even with such details it would remain a generic abalone MSE (__`r fig_nums("f1",display="cite")`__).

It is possible to take such conditioning a step further and customize the details of the biology of each _population_, or at least each _SAU_ making up the spatial structure, to reflect the biology known for a real fishery _zone_. One could also scale predicted productivity and cpue to match a real fishery. This would be less generic but still not closely fitted to a real fishery. The detailed spatial structure internal to the operating model is what makes it impossible to fit the operating model to fishery data as a whole. However, it would still be possible to fit the productivity and history of individual SAU to real fishery data and thereby gain estimates of actual productivity and possibly even recruitment deviates (see _Conditioning the aMSE_). Of course, while this latter approach would appear, at first glance, to be the best strategy for examining a harvest strategy, as it might operate in a real situation, it is also the most demanding in terms of data and difficulty. One can spend large amounts of time iteratively improving an operating model fit to observed catches, length-composition, and CPUE data for each SAU (__`r fig_nums("f1",display="cite")`__). While this is a fine way to spend time it is also a good strategy to remember that there is this spectrum of how closely one reflects nature and that some questions do not require the best possible fit to remain useful.

# The _control.csv_ File

The control file is made up of a series of sections and each will be described in turn, using where possible, the example as generated by the function _ctrlzonetemplate_. Within the _control.csv_ file (which can have any name you wish, it does not have to be _control.csv_) main section headings are written using capital letters for increased clarity. The correct spelling of such section titles is important, as is the spelling of the variable names in the first column. The order of the sections does not need to be strictly maintained but the order of any components within each section must be maintained as described. This is required because in a number of cases they are being parsed in sequence, though many are also being obtained explicitly by name (which is why typing/spelling the names correctly is also important). Where the labels or names are not clear as to the intent of the variable then a description can be given to the right of the actual values.

The intent is to have the input file contents sent to an output text file as they are parsed, so that if the reading of data fails then the point at which it fails is made clear, but this has still to be implemented.

### DESCRIPTION

At the top of the file is an optional description section that can be used to describe the objective of the scenario implied by the control and population files. The author can add as many lines of text to this section as desired as, currently, it is not used in the model run. This may change later so it may act as meta-data for each run. It would be useful to treat this section as such meta-data anyway.

_DESCRIPTION_ 

_Control file containing details of a particular run. Modify the_

_contents to suit your own situation. In particular. modify the_  

_contents of this description to suit the scenario being executed_ 

_use as many lines as required for your own description_


### START

The start section currently only has three components, a name for the particular run (which no longer gets used, though it remains presents and so could be used) and the full name of the _saubiology.csv_ file (which is expected to be found in the _datadir_, which may or may not be the same as the _rundir_). In each case, note the use of commas to separate the variable's label from the variable's value (cannot be seen if opened in Excel, but as long as the file is saved as a csv file all will be well). The hopefully descriptive text after the variable's value is ignored by the program and can be expanded if desired (as long as it remains as a single line). 

_START_

* _runlabel,	 zoneX,	 label for particular run currently ignored_
* _datafile,	 zonewest.csv,	 name of popdefs file = saubiology.csv_
* _bysau,      1, 1=TRUE, 0 = FALSE are we expecting population data by SAU or population_


### zoneCOAST

The zoneCOAST section (an odd name, which may change to become something more descriptive) currently contains five components These determine whether the run will be a batch job (currently not implemented so defaults to 0 = FALSE), how many replicates the projections in the run will have (in a real run this would be something more like 500 or 1000), and a listing of three sources of variation to be included when perfect knowledge (as perfect data) is not to be the case. Other sources of uncertainty will be added here as they are included in the dynamics of projection. 

_zoneCOAST_

* _batch,  0, run job interactively or as a batch (0 = FALSE)_ 
* _replicates,  100, number of replicates, usually 500 or 1000_ 
* _withsigR,  0.3, recruitment variability eg 0.3_ 
* _withsigB,  0.05, process error on exploitable biomass_ 
* _withsigCE, 1e-08, process error on cpue calculations_  

_withsigR_ is the year-to-year recruitment variability. This does not include any special recruitment events or recruitment deviates that may be included (still to be developed). During the generation of the equilibrium, unfished model recruitment variation is set to a very small number, 1e-08, so that recruitment processes are effectively deterministic off the Beverton-Holt stock recruitment relationship. While there is no evidence of auto-correlated recruitment residuals these will be included as an option, but this is still to be implemented. 


$$R_{p,t}=\frac{4h{R_0}{B_{p,t}^{S}}}{(1-h){B_0}+(5h-1){B_{p,t}^{S}}} e^{\varepsilon_{p,t}-\sigma_{R}^2/2}$$

where $\varepsilon_{p,t}$ is defined as:

$$\varepsilon_{p,t}=N \left(0,\sigma_{R}^2 \right)$$

_withsigB_ the fleet dynamics of where divers elect to take their catches within an SAU mean that the actual catches from each SAU differ from the aspirational catches allocated to each SAU according to whatever harvest control rule is used. This will be determined within the _jurisdictionHS.R_ file and may be different to the description given here, which reflects the case in Tasmania.  This is implemented by first allocating catches to the _SAU_ in a deterministic manner and then modifying them by imputing variability to the perceived distribution of biomass among _SAU_ $u$, which is then proagated across compoent _populations_:

$$B_{u,t}^{E,*}={B_{u,t}^{E}}e^{\varepsilon_{u,t}-\sigma_{B}^2/2}$$

where:

$$\varepsilon_{u,t}=N \left(0,\sigma_{B}^2 \right)$$

$\sigma_B$ is the standard deviation of the variation that occurs between the real exploitable biomass and the perceived distribution of exploitable biomass across _SAU's_, and also includes other sources of uncertainty.

This variation is introduced into the potential _SAU_ catches using:

$$C_{u,t}^*=TAC_t \times \frac{B_{u,t}^{E,*}}{\sum{B_{u,t}^{E}}}$$

where $TAC_t$ is the sum of the HCR's aspirational catches. One diagnostic used during conditioning is to examine the variation between the actual catches and those previously determined by the HCR, if one has such data. Otherwise, it should be characterized from the outputs, which will allow its variation to be examined for plausibility.

### ZONE

Again the use of commas to separate variable values is essential. The zone is defined in terms of the number of _SAU_ (spatial assessment units) it is made up of.  

_ZONE_

* _nSAU, 8, number of spatial management units eg 2_ 
* _SAUpop, 2, 2, 2, 2, 2, 2, 2, 2, number of populations per SAU in sequence_ 
* _SAUnames, blk6, blk7, blk8, blk9, blk10, blk11, blk12, blk13, labels for each SAU_ 
* _initdepl, 0.4, 0.4, 0.4, 0.35, 0.35, 0.35, 0.35, 0.35, initial depletion levels for each SAU_ 

The example file from _ctrlzonetemplate_ imputes equal numbers of populations among SAU, this need not be the case. The SAUnames should be only mixtures of letters and numbers but must not contain spaces. The _initdepl_ is the intended initial depletion before either the model run or further conditioning.

### SIZE

The size structure of the operating model was originally built to suit the Tasmanian blacklip abalone fishery. Hence it extends the midpoints of each 2mm size class from 2mm - 210mm, with the 210mm class being a plus group. These values will not necessarily make sense for other jurisdictions or species. _Haliotis roie_, for example, will require a much smaller upper size, and might possibly use 1mm size classes, depending on how data are collected.


_SIZE_

* _minc, 2, centre of minimum size class, classes are 1-3,3-5,5-7..., centered at 2,4,6,..._
* _cw, 2, class width mm_
* _Nclass, 105, number of size classes, leading to a maximum of 210mm_ 


### RECRUIT

Larval movement between Tasmanian blacklip populations has been demonstrated to be remarkably low. Nevertheless, there will undoubtedly be some small amount of larval drift between populations, which operate on a smaller sale than the SAU within which they are found. With no other real data on this it is assumed that the populations are generally aligned linearly along the coastline and such larval movement is a constant rate. 

_RECRUIT_

_larvdisp, 0.01, rate of larval dispersal eg 0.01 = 1.0 percent_ 

The value of _larvdisp_ is used to construct a simple larval movement matrix that assumes movement only occurs between adjacent populations at a rate of half the _larvdisp_ value. While a value of 0.01 may appear almost trivial this does effect the equilibrium dynamics, but the effects are only minor. However, by including this it is now possible to determine the explicit effect of different levels of larval movement, and this would enable the importance of the relative isolation of the different species to be explored.


### RANDOM

There will often be a need to control the generation of random numbers used during both the definition of the populations and the projections. The use of a random seed is especially important when conditioning the operating model as many random numbers are used during that process and if the conditioning is intending to simulate a specific fishery then the distribution of productivity needs to remain the same during each model run. The truth of this will become more apparent during the description of the _saubiology.csv_ file contents and uses in sections below. 

The use of specific random seeds might be wanted, for example, if one wanted to be sure to repeat a particular analysis exactly, of perhaps to see only the effect of changing an argument, perhaps the LML, while making no other changes. So, to ensure the production of the same sequence of pseudo-random numbers one uses _set.seed_. Under _RANDOM_ we have two values, the first, _randomseed_ is used for repeatability of population generation when conditioning the model. By default one would expect this to have a value. The second value, _randomseedP_ is used for repeatability during the projections. Each scenario should have a different _randomseed_ and, optionally, _randomseedP_. One can (should) use _getseed()_ from __rutilsMH__ to generate such seeds. It is recommended that one not try to generate one by oneself. 12345 tends to be used more often than would be expected at random(!) so it, and others akin to it are just not good enough. 

If one does not want to set the random seeds and just use any old random sequence that comes along then set _randomseed_ and _randomseedP_ to 0. 

_RANDOM, 		Set these to zero for random starting points._

* _randomseed, 3543304, for repeatability of population definitions_
* _randomseedP, 0, for repeatability of Projections_


### initLML

However the model is to be run (__`r fig_nums("f1",display="cite")`__), all scenarios begin by generating an unfished, equilibrium model. This includes a characterization of the equilibrium productivity of this population and this will require a selectivity to be used, hence we need an initial LML. The fishery productivity is altered when the LML is changed because it alters the balance between natural mortality, growth, and fishing mortality. In one of the vignettes, an example is given of running the model to equilibrium under different LML and plotting up the productivity and tabulating the MSY, which shows that smaller LML do not always generate the highest levels of productivity (although that also, of course, depends upon the biological properties of growth).

_initLML, 140,  used to generate unfished zone if no historical catches and LML present_

If the conditioning is to include the application of historical catches the different SAU will still require an initial depletion (which can be set at 1.0) and an initial LML. If conditioning on historical catches then it makes sense to initiate the model at the LML in use at the start of the historical catches. If a generic MSE is being conducted, for example, a generic west coast Tasmania starting projections in 2020 or 2021, then perhaps initiate the model at an LML of 140, although, as in the file generated by _ctrlzonetemplate_, project the dynamics forward with an LML of 145 (see PROJLML later).


### PROJECT

Basic information about the projection period of the simulations. The firstyear and lastyear values are currently not used but remain available. We add together the projection years (here 30) and the inityrs value to obtain the total number of years of the final projections

_PROJECT, 30, number of projection years for each simulation_

* _firstyear, 2020, not currently used_
* _lastyear, 2049, not currently used_  



### HARVESTS

This section is no longer used but remains in case a future use arises. It is no longer searched for within the _readctrlfile_ function so nothing placed in this section will influence a run (assuming other key words are not placed here!). 

Instead, we now use a _jusrisdictionHS.R_ file (e.g. _tasmanianHS.R_) to contain functions and constants dealing with particular harvest strategies. A separate document will describe the minimum structural requirements of such source files.


### PROJLML

Under the _PROJECT_ heading we read in the number of projection years. Assuming that was > 0, then _readctrlfile_ looks for the heading _PROJLML_. The LML used in the projections are listed here explicitly so that changes through time can be easily implemented. There needs to be at least as many defined as the value of _PROJECT_ (which becomes _projyrs_), here that is 30. The projLML are used to define the selectivity for each of the projyrs during the projections. They are included in the _projC_ object. 


_PROJLML, need at least the same number as there are projection years_

* _2020,145,  the year and the Legal Minimum Length (LML, MLL, MLS) e.g. 140_
* _2021,145,_
* _2022,145,_
* _2023,145,_
* _..._
* _..._
* _2074,145,_


### CATCHES

If _CATCHES_ is > 0 then one would need to include at least that number of years of historical catches by SAU along with the year and LML that was used when the catches were taken. An example is given below of the required format. If  _CATCHES_ = 0, then any data here will be ignored. If _CATCHES_ > 0 then _readctrlfile looks for _CondYears_ and then reads in _CATCHES_ rows with the followi9ng format.

_CONDITION,0, if > 1 then how many years in the histLML_

* _CondYears,LML,6,7,8,9,10,11,12,13,  names of the columns_
* _1973,132,0,0,0,0,0,0,0,0,_
* _1974,132,8,1,0,3,24,82,143,16, the year, the LML, the catches by SAU_
* _1975,132,21,36,42,126,130,191,143,43,_
* _..._
* _..._
* _2019,132,30,56,77,252,179,240,153,62,_


### CEYRS

_CEYRS_ is similar to _CATCHES_ in that it defines how many years of cpue data will be read in. The required format is given below for _CEYRS_ = 28. If _CEYRS_ = 0, then any cpue data will be ignored. Note that in the early years there appears to be cpue data missing from SAU6 and SAU13, which are present in the latest years. This is because, in Tasmania, zonation was only introduced in 2000, so cross-zone blocks such as 6 and 13 cannot be included prior to 2000.

_,6,7,8,9,10,11,12,13,_

_CEYRS,28,  if >0 then number reflects number of historical CPUE records by SAU_

* _1992, ,113.4, 94.2, 97.0, 99.4, 98.1, 100.19, ,_
* _1993, ,116.8, 110.38, 109.37, 99.1, 107.88, 102.20, ,_
* _..._
* _..._
* _2018, 106.68, 143.57, 148.43, 133.70, 104.38, 95.01, 106.88, 104.08,_
* _2019, 92.22, 112.70, 107.11, 93.65, 91.89, 86.94, 90.03, 90.78,_

### SIZECOMP

Size-composition data is akin to the biological properties data in being potentially a large amount of data which might confuse the structure and editing of of the _control_ file. Hence we use this to refer to a filename containing the required data. If _SIZECOMP_ = 0 then no file will be read in, otherwise a list of filenames will be expected and these should be stored in the _datadir_. The filenames should begin in the row immediately below _SIZECOMP_.

_SIZECOMP,1_

_laterdata,lateLF-84-20.csv_


<br><br>

# The _saubiology.csv_ File


This file is identified in the _control_ file. This also starts off with some optional descriptive text lines.

_SAU definitions listing Probability density function parameters for each variable_

_These are randomly aligned to each population except for the proportion of recruitment,_ 

_which is literally allocated down in the popREC section_

As many of these as are required can be included. The real input is signaled by the _SPATIAL_ heading, though this is not currently used explicitly. The _saubiology.csv_ file contents are read in by the function _readsaudatafile_, and each variable is identified and selected by its name (so type carefully), though they are split into groups that relate to their function. First there are lines describing the implied geographical structure being simulated, then comes a matrix of properties for each _SAU_, following on from the _VARS_ heading.

Not all variables input are used to define probability density functions. Thus, each of the _nsau_, _saupop_, _saunames_ are defined explicitly after deciding on the geographical structure to impose. They need to be listed in the order in which they are expected to occur along the coast. Each population is a member of a given _SAU_, and here we are using the Tasmanian block number as the SAU index (and the _saunames_). Each SAU can have a different number of populations. 

_SPATIAL_

* _nsau, 8, number of spatial management units eg 2_
* _saupop, 3, 3, 2, 2, 2, 2, 12, 2, number of populations per SAU in sequence_
* _saunames, 6, 7, 8, 9, 10, 11, 12, 13, labels for each SAU_
* _initdepl, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7, initial depletion levels for each SAU_

The _initdepl_ value is only used if an abstract or truly generic abalone stock is intended. If the intent is to model a plausibly realistic generic stock, or a specific and real abalone stock then this line, while read, is not used.


### PDFS

_PDFs, 30, _

This line is read in to determine the number of variable values to be read (the rows to the matrix). The columns of the matrix are defined by the _nsau_ defined above.

The precision with which this matrix is filled will constitute a large part of any conditioning. Approximate and plausible values will produce a generic MSE whereas, tuning the matrix to the biological properties of a particular zone, as best one can, will generate a much more specific MSE, especially if that is followed up by conditioning the resulting modelled stock on historical fishery data. Thus, if one then included historical catches and other fishery data the result would be as realistic a modelled representation as one could get. 

Here we only generate a plausible and generic zone, as can be inferred by the repeated values (which will still lead to different values between populations because the variability in each case - variables prefixed s, are all large enough to influence a random number). If specific values for a given population are wanted then set the respective variation value to 1e-08. All variables are sampled from a Normal distribution except for the average unfished recruitment, which strongly defines the upper productivity of each population, and is sampled from a log-normal distribution (see the function _definepops_).


### Growth

The parameters of the Inverse Logistic model describing growth (Haddon _et al_, 2008; Haddon & Mundy, 2016). Alternative growth functions will be implemented in the future and will be selected in this section. In each case there is the main parameter (MaxDL, L50, L50inc, and SigMAx) followed immediately by the variation to be attributed to a given population's value through sampling from a normal distribution. If values varying around a specific value are wanted for a given _SAU_, then set the respective variation value to 1e-08. 

* _MaxDL ,26, 30, 30, 34, 34, 34, 34, 29, maximum growth increment_
* _sMaxDL ,2, 2, 2, 2, 2, 2, 2, 2, variation of MaxDL within each SAU_
* _L50 ,135.276, 135.276, 135.276, ..., ..., ..., ..., ..., Length at 50% MaxDL_
* _sL50 ,2, 2, 2, 2, 2, 2, 2, 2, variation of L50_
* _L50inc ,39, 39, 39, 39, 39, 39, 39, 39, L95 - L50 = delta =L50inc_
* _sL50inc ,1.5, 1.5, 1.25, 1.25, 1.25, 1.25, 1.25, 1.25, variation of L50inc_
* _SigMax  ,3.3784, 3.3784, 3.3784, ..., ..., ..., ..., ..., max var around growth_
* _sSigMax ,0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, var of SigMax_


### LML

It is not impossible that different SAU operate under different LML, this allows for the generation of the equilibrium zone to reflect such variation if present. If, however, historical catches are available and are to be used, they are defined along with the LML used in each year and those LML are used in the _zone_ definition instead. 

_LML ,132, 132, 132, 132, 132, 132, 132, 132, Initial legal minimum length_ 


### Weight-at-Size

The weight-at-size relationships for each population are defined using the standard equation:

$$W_{p,L}=a_pL_{p}^{b_p}$$
which defines the weight of animals in population $p$ at length $L$. For this we need both the $a_p$ and $b_p$ parameters. It was found in Haddon _et al_ (2013; see pages 208-209) that there was a power relationship between the $b_p$ parameter and its corresponding $a_p$ parameter. So that this relationship is not broken when selecting random comnbinations, first the $b_p$ parameter is produced (sampled from a Normal distribution), and that is used to estimate the $a_p$ parameter, with variation. Given the advent of new samples, and different jurisdictions, in each case this relationship should be estimated first. Given the length/size-based dynamics this relationship is highly influential on the outcomes so effort with respect to this relationship is important.


* _Wtb ,3.161963, 3.161963, 3.161963, ..., ..., ..., ..., ..., weight-at-length exponent_
* _sWtb ,0.148, 0.148, 0.148, 0.148, ..., ..., ..., ..., var of Wtb_
* _Wtbtoa ,962.8098, 962.8098, ..., ..., ..., ..., ..., ..., power curve intercept_
* _sWtbtoa ,-14.3526, -14.3526, ..., ..., ..., ..., ..., ..., power curve exponent_


### Natural Mortality

This is a troublesome variable. Previous work has generally assumed a natural mortality rate of about 0.2, but this suggests that most animals would be close to senile by the age of 23 (only 1 percent would be expected to survive that long). However, very many large animals have been found, despite their growth characteristics implying that to reach such sizes would take longer than 23 years. This casts doubt on the notion of M = 0.2, which, if traced, stems from some rather limited tagging data from decades ago. As with the growth characteristics, tagging may negatively affect survivorship, this potentially affecting any early tagging study of natural mortality (biasing it high). Here we have selected 0.15 as the mean, but the uncertainty means that it would be worthwhile comparing the outcomes of any HS when M = c(0.125, 0.15, 0.2).

* _Me ,0.15, 0.15, 0.15, 0.15, 0.15, 0.15, 0.15, 0.15, Nat Mort_
* _sMe ,0.003, 0.003, 0.003, 0.003, 0.003, 0.003, 0.003, 0.003, var of Me_



### Recruitment

The average unfished recruitment is a major influence on the productivity of each population. During conditioning it is recommended that this be one of the first variables to adjust to set-up each populations unfished production. At very least it should be possible to determine the relative long-term production of each SAU, and this can be used as a guide to determine the relative productivity of each SAU and this should then be distributed among its constituent populations. If a time-series of GPS data-logger information is available (or potentially of a series of surveys) this can be used to scale the relative productivity of each constituent population within SAU (this is done in the _propREC_ section of the _saubiology.csv_ file, as described below). The _AvRec_ value, in each case, is in linear-space for ease of use, but is commonly expressed as log(AvRec) in the model. This is defined using steepness as shown in the _zoneCOAST_ section above.


* _AvRec,222500, 390000, 128000, 745000, 690000, 1420000, 1250000, 375000, unfished recruitment R0_
* _sAvRec,0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, 0.0001, variaiton in R0_
* _defsteep ,0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75, 0.75, Beverton-Holt steepness_
* _sdefsteep ,0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02,_

### Emergence

Emergence has been studied in Tasmania through an examination of the growth of encrusting animals and algae on the animal's shells. The cover by algae (even encrusting algae) being taken as evidence of emergence (exposure to light). This only becomes influential if the emergence curve overlaps with the selectivity curve, which may happen when the LML is low. If no emergence data is present, then just set values so that the emergence curve always runs at smaller sizes than the selectivity curves (see later). These values below are invented (for now).


* _L50C ,126.4222, 126.4222, 126.4222, ..., ..., ..., ..., ..., length at 50% emergent_
* _sL50C ,0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5,_
* _deltaC ,10, 10, 10, 10, 10, 10, 10, 10, length at 95% - 50% emergent_
* _sdeltaC ,0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1,_


### CPUE

In order to scale the predicted cpue we use _MaxCEpar_ to define the maximum cpue expected when exploitable biomass is at its greatest density. This is defined for when cpue is linear related to exploitable biomass, which is why there are some extremely high, and implausible values amongst the maxima. The option of including hyper-stability, which would lead to smaller, more plausible maxima, is being explored but still needs to be implemented and that will require an extra couple of parameters to define the relationship between exploitable biomass and cpue.


* _MaxCEpars, 0.475, 0.475, 0.54, 0.6, 0.55, 0.7, 0.43, 0.43, max cpue t-hr_
* _sMaxCEpars, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02, 0.02,_



### Selectivity

Even though there is an LML, the precision with which abalone are taken with respect to the LML is not always perfect with some legal sized animals being left behind and occasionalyl some just sub-legal being taken (though these may be due to meaasuring error). Here we use a simple addition to the selectivity ogive used for each population.


* _selL50p ,0 ,0, 0, 0, 0, 0, 0, 0, L50 of selectivity, 0 = no bias_
* _selL95p ,1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 1.5, L95 of selectivity_


### Size-at-Maturity

It was found in Haddon _et al_ (2013; see pages 210-211) that there were relationships between the two parameters used to define the logistic maturity-at-size relationships for different populations. A fixed parameter value of -16 for the $a_p$ parameter led to a range of plausible values for the $b_p$ parameter

* _SaMa, -16, -16, -16, -16, -16, -16, -16, -16, maturity logistic a par_
* _L50Mat, 114, 114, 114, 114, 114, 114, 114, 114, L50 for maturity b = -1/L50_
* _sL50Mat, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5, 2.5,_


## propREC

The _propREC_ section provides details for the distribution of the recruitment levels across the populations within each _SAU_. The three columns of values are the _SAU_, the _population_, and its expected proportion of the _SAU_ recruitment each year. These values need to be set manually during the conditioning and varied until the dynamics approximate the desired dynamics.


* _SAU,pop,propR_
* _6, 1, 0.16, in SAU 6 about 1/6 of recruitment goes to pop 1_
* _6, 2, 0.82, in SAU 6  most recruitment goes to pop2_
* _6, 3, 0.02, in SAU 6 almost no recruitment goes to pop3_ 
* _7, 4, 0.31, in SAU 7 a somewhat more even distribution of recruitment occurs _ 
* _7, 5, 0.46_
* _7, 6, 0.23_
* _8, 7, 0.491_
* _..._
* _..._
* _12 ,26, 0.022_
* _13 ,27, 0.5, in SAU 13 an equal distribution is suggested__
* _13 ,28, 0.5_


<br>

## References

Haddon, M., Mayfield, S., Helidoniotis, F., Chick, R. and C. Mundy (2013) _Identification and Evaluation of Performance Indicators for Abalone Fisheries_. FRDC Final Report 2007/020. CSIRO Oceans and Atmosphere and Fisheries Research Development Corporation. 295 p.

Haddon, M. and C. Mundy (2016) _Testing abalone empirical harvest strategies for setting TACs and associated LMLs, which include the use of novel spatially explicit performance measures._ FRDC Final Report 2011/028. CSIRO Oceans and Atmosphere and Fisheries Research Development Corporation. Hobart 182p.

Haddon, M., Mundy, C., and D. Tarbath (2008) Using an inverse-logistic model to describe growth increments of blacklip abalone (_Haliotis rubra_) in Tasmania. _Fishery Bulletin_ __106__:58-71












